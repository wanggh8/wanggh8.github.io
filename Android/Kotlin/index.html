<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Kotlin | Petithao</title><meta name="description" content="基础知识变量变量类型Kotlin声明变量使用 val 和 var 。  val 用于值从不更改的变量。使用 val 声明的变量无法重新赋值。 var 用于值可以更改的变量。 val 声明一个指向数组的变量时，引用不可变，不能指向另一个数组，但可以修改指向数组的值 val 数组存储在堆内存中，引用不可更改，其引用对象可以更改 val 声明一个本身不可变的变量，可以减少函数副作用  Kotlin中的数"><meta name="keywords" content="Android"><meta name="author" content="wanggh8"><meta name="copyright" content="wanggh8"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/head.jpg"><link rel="canonical" href="https://129921.xyz/Android/Kotlin/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Kotlin"><meta property="og:url" content="https://129921.xyz/Android/Kotlin/"><meta property="og:site_name" content="Petithao"><meta property="og:description" content="基础知识变量变量类型Kotlin声明变量使用 val 和 var 。  val 用于值从不更改的变量。使用 val 声明的变量无法重新赋值。 var 用于值可以更改的变量。 val 声明一个指向数组的变量时，引用不可变，不能指向另一个数组，但可以修改指向数组的值 val 数组存储在堆内存中，引用不可更改，其引用对象可以更改 val 声明一个本身不可变的变量，可以减少函数副作用  Kotlin中的数"><meta property="og:image" content="https://129921.xyz/images/kotlin.png"><meta property="article:published_time" content="2020-08-27T09:23:12.000Z"><meta property="article:modified_time" content="2021-02-14T15:35:03.571Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.1.1',
  algolia: undefined,
  localSearch: {"path":"mysearch.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-02-14 23:35:03'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><link rel="stylesheet" href="/self/xcode.css"><meta name="generator" content="Hexo 5.1.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="/img/head.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">67</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">22</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="toc-number">1.</span> <span class="toc-text">基础知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.1.</span> <span class="toc-text">变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">变量类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E6%96%AD"><span class="toc-number">1.1.2.</span> <span class="toc-text">类型推断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Null-%E5%AE%89%E5%85%A8"><span class="toc-number">1.1.3.</span> <span class="toc-text">Null 安全</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88"><span class="toc-number">1.1.4.</span> <span class="toc-text">集合</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E7%9A%84%E5%87%BD%E6%95%B0%E5%BC%8FAPI"><span class="toc-number">1.1.4.1.</span> <span class="toc-text">集合的函数式API</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.2.</span> <span class="toc-text">条件语句</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#if-else-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.2.1.</span> <span class="toc-text">if-else 语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#when-%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.2.2.</span> <span class="toc-text">when 语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96%E5%87%BD%E6%95%B0%E5%A3%B0%E6%98%8E"><span class="toc-number">1.3.1.</span> <span class="toc-text">简化函数声明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.2.</span> <span class="toc-text">匿名函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0"><span class="toc-number">1.3.3.</span> <span class="toc-text">高阶函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">Lambda表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95%E7%B3%96"><span class="toc-number">1.4.1.</span> <span class="toc-text">语法糖</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB"><span class="toc-number">1.5.</span> <span class="toc-text">类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">1.5.1.</span> <span class="toc-text">属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%87%BD%E6%95%B0%E5%92%8C%E5%B0%81%E8%A3%85"><span class="toc-number">1.5.2.</span> <span class="toc-text">类函数和封装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%92%E6%93%8D%E4%BD%9C%E6%80%A7"><span class="toc-number">1.6.</span> <span class="toc-text">互操作性</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">基本语法</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">常用用法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E7%B1%BB"><span class="toc-number">2.1.1.</span> <span class="toc-text">创建数据类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0"><span class="toc-number">2.1.2.</span> <span class="toc-text">函数的默认参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4-list"><span class="toc-number">2.1.3.</span> <span class="toc-text">过滤 list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A3%80%E6%B5%8B%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E4%BA%8E%E9%9B%86%E5%90%88%E4%B8%AD"><span class="toc-number">2.1.4.</span> <span class="toc-text">检测元素是否存在于集合中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%86%85%E6%8F%92"><span class="toc-number">2.1.5.</span> <span class="toc-text">字符串内插</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%A4%E6%96%AD"><span class="toc-number">2.1.6.</span> <span class="toc-text">类型判断</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%8D%E5%8E%86-map-pair%E5%9E%8Blist"><span class="toc-number">2.1.7.</span> <span class="toc-text">遍历 map&#x2F;pair型list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8C%BA%E9%97%B4"><span class="toc-number">2.1.8.</span> <span class="toc-text">使用区间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AA%E8%AF%BB-list"><span class="toc-number">2.1.9.</span> <span class="toc-text">只读 list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AA%E8%AF%BB-map"><span class="toc-number">2.1.10.</span> <span class="toc-text">只读 map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE-map"><span class="toc-number">2.1.11.</span> <span class="toc-text">访问 map</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BB%B6%E8%BF%9F%E5%B1%9E%E6%80%A7"><span class="toc-number">2.1.12.</span> <span class="toc-text">延迟属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.13.</span> <span class="toc-text">扩展函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%8D%95%E4%BE%8B"><span class="toc-number">2.1.14.</span> <span class="toc-text">创建单例</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#If-not-null-%E7%BC%A9%E5%86%99"><span class="toc-number">2.1.15.</span> <span class="toc-text">If not null 缩写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#If-not-null-and-else-%E7%BC%A9%E5%86%99"><span class="toc-number">2.1.16.</span> <span class="toc-text">If not null and else 缩写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-null-%E6%89%A7%E8%A1%8C%E4%B8%80%E4%B8%AA%E8%AF%AD%E5%8F%A5"><span class="toc-number">2.1.17.</span> <span class="toc-text">if null 执行一个语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8%E5%8F%AF%E8%83%BD%E4%BC%9A%E7%A9%BA%E7%9A%84%E9%9B%86%E5%90%88%E4%B8%AD%E5%8F%96%E7%AC%AC%E4%B8%80%E5%85%83%E7%B4%A0"><span class="toc-number">2.1.18.</span> <span class="toc-text">在可能会空的集合中取第一元素</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#if-not-null-%E6%89%A7%E8%A1%8C%E4%BB%A3%E7%A0%81"><span class="toc-number">2.1.19.</span> <span class="toc-text">if not null 执行代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%98%A0%E5%B0%84%E5%8F%AF%E7%A9%BA%E5%80%BC%EF%BC%88%E5%A6%82%E6%9E%9C%E9%9D%9E%E7%A9%BA%E7%9A%84%E8%AF%9D%EF%BC%89"><span class="toc-number">2.1.20.</span> <span class="toc-text">映射可空值（如果非空的话）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E-when-%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.1.21.</span> <span class="toc-text">返回 when 表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9Ctry-catch%E2%80%9D%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.1.22.</span> <span class="toc-text">“try&#x2F;catch”表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%80%9Cif%E2%80%9D%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.1.23.</span> <span class="toc-text">“if”表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B%E4%B8%BA-Unit-%E7%9A%84%E6%96%B9%E6%B3%95%E7%9A%84-Builder-%E9%A3%8E%E6%A0%BC%E7%94%A8%E6%B3%95"><span class="toc-number">2.1.24.</span> <span class="toc-text">返回类型为 Unit 的方法的 Builder 风格用法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.25.</span> <span class="toc-text">单表达式函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%B8%80%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%AE%9E%E4%BE%8B%E8%B0%83%E7%94%A8%E5%A4%9A%E4%B8%AA%E6%96%B9%E6%B3%95-%EF%BC%88with%EF%BC%89"><span class="toc-number">2.1.26.</span> <span class="toc-text">对一个对象实例调用多个方法 （with）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%EF%BC%88apply%EF%BC%89"><span class="toc-number">2.1.27.</span> <span class="toc-text">配置对象的属性（apply）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-7-%E7%9A%84-try-with-resources"><span class="toc-number">2.1.28.</span> <span class="toc-text">Java 7 的 try with resources</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E4%BA%8E%E9%9C%80%E8%A6%81%E6%B3%9B%E5%9E%8B%E4%BF%A1%E6%81%AF%E7%9A%84%E6%B3%9B%E5%9E%8B%E5%87%BD%E6%95%B0%E7%9A%84%E9%80%82%E5%AE%9C%E5%BD%A2%E5%BC%8F"><span class="toc-number">2.1.29.</span> <span class="toc-text">对于需要泛型信息的泛型函数的适宜形式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%8F%AF%E7%A9%BA%E5%B8%83%E5%B0%94"><span class="toc-number">2.1.30.</span> <span class="toc-text">使用可空布尔</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2%E4%B8%A4%E4%B8%AA%E5%8F%98%E9%87%8F"><span class="toc-number">2.1.31.</span> <span class="toc-text">交换两个变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#TODO-%EF%BC%9A%E5%B0%86%E4%BB%A3%E7%A0%81%E6%A0%87%E8%AE%B0%E4%B8%BA%E4%B8%8D%E5%AE%8C%E6%95%B4"><span class="toc-number">2.1.32.</span> <span class="toc-text">TODO()：将代码标记为不完整</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E8%A7%84%E8%8C%83"><span class="toc-number">2.2.</span> <span class="toc-text">编码规范</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0"><span class="toc-number">2.2.1.</span> <span class="toc-text">源文件名称</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E6%96%87%E4%BB%B6%E7%BB%84%E7%BB%87"><span class="toc-number">2.2.2.</span> <span class="toc-text">源文件组织</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%B8%83%E5%B1%80"><span class="toc-number">2.2.3.</span> <span class="toc-text">类布局</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(/images/kotlin-android.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Petithao</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></li><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Kotlin</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-08-27T09:23:12.000Z" title="发表于 2020-08-27 17:23:12">2020-08-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-02-14T15:35:03.571Z" title="更新于 2021-02-14 23:35:03">2021-02-14</time></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a>基础知识</h1><h2 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h2><h3 id="变量类型"><a href="#变量类型" class="headerlink" title="变量类型"></a>变量类型</h3><p>Kotlin声明变量使用 <code>val</code> 和 <code>var</code> 。</p>
<ul>
<li><code>val</code> 用于值从不更改的变量。使用 <code>val</code> 声明的变量无法重新赋值。</li>
<li><code>var</code> 用于值可以更改的变量。</li>
<li><code>val</code> 声明一个指向数组的变量时，引用不可变，不能指向另一个数组，但可以修改指向数组的值</li>
<li><code>val</code> 数组存储在堆内存中，引用不可更改，其引用对象可以更改</li>
<li><code>val</code> 声明一个本身不可变的变量，可以减少函数副作用</li>
</ul>
<p>Kotlin中的数据类型都为对象类，具体如下：</p>
<table>
<thead>
<tr>
<th align="center">Java基本数据类型</th>
<th align="center">Kotlin对象数据类型</th>
<th align="center">数据类型说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">int</td>
<td align="center">Int</td>
<td align="center">整型</td>
</tr>
<tr>
<td align="center">long</td>
<td align="center">Long</td>
<td align="center">长整型</td>
</tr>
<tr>
<td align="center">short</td>
<td align="center">Short</td>
<td align="center">短整型</td>
</tr>
<tr>
<td align="center">float</td>
<td align="center">Float</td>
<td align="center">单精度浮点型</td>
</tr>
<tr>
<td align="center">double</td>
<td align="center">Double</td>
<td align="center">双精度浮点型</td>
</tr>
<tr>
<td align="center">boolean</td>
<td align="center">Boolean</td>
<td align="center">布尔型</td>
</tr>
<tr>
<td align="center">char</td>
<td align="center">Char</td>
<td align="center">字符型</td>
</tr>
<tr>
<td align="center">byte</td>
<td align="center">Byte</td>
<td align="center">字节型</td>
</tr>
</tbody></table>
<h3 id="类型推断"><a href="#类型推断" class="headerlink" title="类型推断"></a>类型推断</h3><p>赋予变量初始值后 Kotlin 编译器可根据所赋值的类型来推断其类型。也可以指定变量类型</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> languageName = <span class="hljs-string">&quot;Kotlin&quot;</span><br><span class="hljs-keyword">val</span> hello : String = <span class="hljs-string">&quot;Kotlin&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="Null-安全"><a href="#Null-安全" class="headerlink" title="Null 安全"></a>Null 安全</h3><p>在某些语言中，可以声明引用类型变量而不明确提供初始值。在这类情况下，变量通常包含 <code>null</code> 值。默认情况下，Kotlin 变量不能持有 <code>null</code> 值。这意味着以下代码段无效：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// Fails to compile</span><br><span class="hljs-keyword">val</span> languageName: String = <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure>

<p>要使变量持有 <code>null</code> 值，它必须是可为 <code>null</code> 类型。可以在变量类型后面加上 <code>?</code> 后缀，将变量指定为可为 <code>null </code>，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> languageName: String? = <span class="hljs-literal">null</span><br></code></pre></td></tr></table></figure>

<p>指定 <code>String?</code> 类型后，可以为 <code>languageName</code> 赋予 <code>String</code> 值或 <code>null</code>。</p>
<p>使用 <code>!!</code>断言自己使用的值不为空，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> languageName: String? = <span class="hljs-literal">null</span><br>languageName!!<br></code></pre></td></tr></table></figure>

<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>不可变集合初始化（不可增删改）：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> list = listOf(<span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;banana&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>)<br><span class="hljs-keyword">val</span> <span class="hljs-keyword">set</span> = setOf(<span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;banana&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>可变集合初始化：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> list = mutableListOf(<span class="hljs-string">&quot;apple&quot;</span>, <span class="hljs-string">&quot;banana&quot;</span>, <span class="hljs-string">&quot;orange&quot;</span>)<br>list.add(<span class="hljs-string">&quot;Pear&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>集合遍历：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">for</span> (fruit <span class="hljs-keyword">in</span> list) &#123;<br>    println(fruit)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Map集合初始化：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">// 写法1</span><br><span class="hljs-keyword">val</span> map = HashMap&lt;String, <span class="hljs-built_in">Int</span>&gt;()<br>map[<span class="hljs-string">&quot;apple&quot;</span>] = <span class="hljs-number">1</span><br>map[<span class="hljs-string">&quot;banana&quot;</span>] = <span class="hljs-number">2</span><br>map[<span class="hljs-string">&quot;orange&quot;</span>] = <span class="hljs-number">3</span><br><br><span class="hljs-comment">// 写法2</span><br><span class="hljs-keyword">val</span> map = mapOf(<span class="hljs-string">&quot;apple&quot;</span> to <span class="hljs-number">1</span>, <span class="hljs-string">&quot;banana&quot;</span> to <span class="hljs-number">2</span>, <span class="hljs-string">&quot;orange&quot;</span> to <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>

<p>Map集合遍历：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">for</span> ((fruit, number) <span class="hljs-keyword">in</span> map) &#123;<br>    println(<span class="hljs-string">&quot;fruit is &quot;</span> + fruit + <span class="hljs-string">&quot;, number is &quot;</span> + number)<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="集合的函数式API"><a href="#集合的函数式API" class="headerlink" title="集合的函数式API"></a>集合的函数式API</h4><h2 id="条件语句"><a href="#条件语句" class="headerlink" title="条件语句"></a>条件语句</h2><h3 id="if-else-语句"><a href="#if-else-语句" class="headerlink" title="if-else 语句"></a>if-else 语句</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">if</span> (count == <span class="hljs-number">42</span>) &#123;<br>    println(<span class="hljs-string">&quot;I have the answer.&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">35</span>) &#123;<br>    println(<span class="hljs-string">&quot;The answer is close.&quot;</span>)<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    println(<span class="hljs-string">&quot;The answer eludes me.&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<p>编写这些语句时会出现重复， Kotlin 提供了条件表达式，每个条件分支都隐式地返回其最后一行的表达式的结果，因此无需使用 <code>return</code> 关键字。利用类型推断可以省略 <code>answerString</code> 的显式类型声明，但为了清楚起见，通常最好添加该声明。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> answerString: String = <span class="hljs-keyword">if</span> (count == <span class="hljs-number">42</span>) &#123;<br>    <span class="hljs-string">&quot;I have the answer.&quot;</span><br>&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (count &gt; <span class="hljs-number">35</span>) &#123;<br>    <span class="hljs-string">&quot;The answer is close.&quot;</span><br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-string">&quot;The answer eludes me.&quot;</span><br>&#125;<br><br>println(answerString)<br></code></pre></td></tr></table></figure>

<h3 id="when-语句"><a href="#when-语句" class="headerlink" title="when 语句"></a>when 语句</h3><p>条件语句的复杂性不断增加，您可以考虑将 if-else 表达式替换为 when 表达式，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> answerString = <span class="hljs-keyword">when</span> &#123;<br>    count == <span class="hljs-number">42</span> -&gt; <span class="hljs-string">&quot;I have the answer.&quot;</span><br>    count &gt; <span class="hljs-number">35</span> -&gt; <span class="hljs-string">&quot;The answer is close.&quot;</span><br>    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-string">&quot;The answer eludes me.&quot;</span><br>&#125;<br><br>println(answerString)<br></code></pre></td></tr></table></figure>

<p><code>when</code> 表达式中每个分支都由一个条件、一个箭头 (<code>-&gt;</code>) 和一个结果来表示。如果箭头左侧的条件求值为 true，则会返回右侧的表达式结果。请注意，执行并不是从一个分支跳转到下一个分支。<code>when</code> 表达式示例中的代码在功能上与上一个示例中的代码等效。</p>
<p><code>when</code> 表达式可以传入参数：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">describe</span><span class="hljs-params">(obj: <span class="hljs-type">Any</span>)</span></span>: String =<br>    <span class="hljs-keyword">when</span> (obj) &#123;<br>        <span class="hljs-number">1</span>          -&gt; <span class="hljs-string">&quot;One&quot;</span><br>        <span class="hljs-string">&quot;Hello&quot;</span>    -&gt; <span class="hljs-string">&quot;Greeting&quot;</span><br>        <span class="hljs-keyword">is</span> <span class="hljs-built_in">Long</span>    -&gt; <span class="hljs-string">&quot;Long&quot;</span><br>        !<span class="hljs-keyword">is</span> String -&gt; <span class="hljs-string">&quot;Not a string&quot;</span><br>        <span class="hljs-keyword">else</span>       -&gt; <span class="hljs-string">&quot;Unknown&quot;</span><br>    &#125;<br></code></pre></td></tr></table></figure>

<p>Kotlin 的条件语句彰显了它的一项更强大的功能，即智能类型转换。您不必使用安全调用运算符或非 null 断言运算符来处理可为 null 的值，而可以使用条件语句来检查变量是否包含对 null 值的引用，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> languageName: String? = <span class="hljs-literal">null</span><br><span class="hljs-keyword">if</span> (languageName != <span class="hljs-literal">null</span>) &#123;<br>    <span class="hljs-comment">// No need to write languageName?.toUpperCase()</span><br>    println(languageName.toUpperCase())<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在条件分支中，<code>languageName</code> 可能会被视为不可为 null。Kotlin 非常智能，能够识别执行分支的条件是 <code>languageName</code> 不持有 null 值，因此您不必在该分支中将 <code>languageName</code> 视为可为 null。这种智能类型转换适用于 null 检查、<a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/reference/typecasts.html#is-and-is-operators">类型检查</a>，或符合<a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/reference/whatsnew13.html#contracts">合约</a>的任何条件。</p>
<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>要声明函数，请使用 <code>fun</code> 关键字，后跟函数名称。接下来，定义函数接受的输入类型（如果有），并声明它返回的输出类型。函数的主体用于定义在调用函数时调用的表达式。函数语法规则：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">methodName</span><span class="hljs-params">(param1: <span class="hljs-type">Int</span>, param2: <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="简化函数声明"><a href="#简化函数声明" class="headerlink" title="简化函数声明"></a>简化函数声明</h3><p>函数返回单个表达式的结果时，可以通过直接返回函数中包含的 if-else 表达式的结果来跳过声明局部变量，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generateAnswerString</span><span class="hljs-params">(countThreshold: <span class="hljs-type">Int</span>)</span></span>: String &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">if</span> (count &gt; countThreshold) &#123;<br>        <span class="hljs-string">&quot;I have the answer.&quot;</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-string">&quot;The answer eludes me.&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>还可以将 return 关键字替换为赋值运算符：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">generateAnswerString</span><span class="hljs-params">(countThreshold: <span class="hljs-type">Int</span>)</span></span>: String = <span class="hljs-keyword">if</span> (count &gt; countThreshold) &#123;<br>        <span class="hljs-string">&quot;I have the answer&quot;</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-string">&quot;The answer eludes me&quot;</span><br>    &#125;<br></code></pre></td></tr></table></figure>

<h3 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h3><p>并非每个函数都需要一个名称。某些函数通过输入和输出更直接地进行标识。这些函数称为“匿名函数”。</p>
<ul>
<li><code>-&gt;</code> 符号组织参数类型和返回值类型，左边是参数类型，右边是返回值类型</li>
<li>必须用一个括号包裹参数类型</li>
<li>返回值类型必须显式声明</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">(<span class="hljs-built_in">Int</span>, String) -&gt; <span class="hljs-built_in">Unit</span><br></code></pre></td></tr></table></figure>

<p>Kotlin 也支持为声明参数指定名字，如下所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">(errCode: <span class="hljs-built_in">Int</span>, errMsg: String) -&gt; <span class="hljs-built_in">Unit</span><br></code></pre></td></tr></table></figure>

<p>如果该匿名函数类型的变量是可选的，可以使用：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">((errCode: <span class="hljs-built_in">Int</span>, errMsg: String) -&gt; <span class="hljs-built_in">Unit</span>)?<br></code></pre></td></tr></table></figure>

<p>您可以保留对某个匿名函数的引用，以便日后使用此引用来调用该匿名函数。与其他引用类型一样，您也可以在应用中传递引用。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> stringLengthFunc: (String) -&gt; <span class="hljs-built_in">Int</span> = &#123; input -&gt;<br>    input.length<br>&#125;<br></code></pre></td></tr></table></figure>

<p>与命名函数一样，匿名函数也可以包含任意数量的表达式。 函数的返回值是最终表达式的结果。</p>
<p>在上面的示例中，<code>stringLengthFunc</code> 包含对一个匿名函数的引用，该函数将 <code>String</code> 当作输入，并将输入 <code>String</code> 的长度作为 <code>Int</code> 类型的输出返回。因此，该函数的类型表示为 <code>(String) -&gt; Int</code>。不过，此代码不会调用该函数。要检索该函数的结果，您必须像调用命名函数一样调用该函数。调用 <code>stringLengthFunc</code> 时，必须提供 <code>String</code>，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> stringLengthFunc: (String) -&gt; <span class="hljs-built_in">Int</span> = &#123; input -&gt;<br>    input.length<br>&#125;<br><br><span class="hljs-keyword">val</span> stringLength: <span class="hljs-built_in">Int</span> = stringLengthFunc(<span class="hljs-string">&quot;Android&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>一个函数可以将另一个函数当作参数。将其他函数用作参数的函数称为“高阶函数”。此模式对组件之间的通信（其方式与在 Java 中使用回调接口相同）很有用。</p>
<p>下面是一个高阶函数的示例：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">stringMapper</span><span class="hljs-params">(str: <span class="hljs-type">String</span>, mapper: (<span class="hljs-type">String</span>) -&gt; <span class="hljs-type">Int</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-comment">// Invoke function</span><br>    <span class="hljs-keyword">return</span> mapper(str)<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>stringMapper()</code> 函数接受一个 <code>String</code> 以及一个函数，该函数根据您传递给它的 <code>String</code> 来推导 <code>Int</code> 值。</p>
<p>要调用 <code>stringMapper()</code>，可以传递一个 <code>String</code> 和一个满足其他输入参数的函数（即，一个将 <code>String</code> 当作输入并输出 <code>Int</code> 的函数），如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">stringMapper(<span class="hljs-string">&quot;Android&quot;</span>, &#123; input -&gt;<br>    input.length<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>如果匿名函数是在某个函数上定义的最后一个参数，则您可以在用于调用该函数的圆括号之外传递它，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">stringMapper(<span class="hljs-string">&quot;Android&quot;</span>) &#123; input -&gt;<br>    input.length<br>&#125;<br></code></pre></td></tr></table></figure>

<p>高阶函数支持返回一个匿名函数：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">(<span class="hljs-built_in">Int</span>) -&gt; ((<span class="hljs-built_in">Int</span>) -&gt; <span class="hljs-built_in">Unit</span>)<br></code></pre></td></tr></table></figure>

<p>支持传入匿名函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">((Int) -&gt; Int) -&gt; Unit<br></code></pre></td></tr></table></figure>

<p>在整个 Kotlin 标准库中可以找到很多匿名函数。如需了解详情，请参阅<a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/reference/lambdas.html">高阶函数和 Lambda</a>。</p>
<h2 id="Lambda表达式"><a href="#Lambda表达式" class="headerlink" title="Lambda表达式"></a>Lambda表达式</h2><ul>
<li>Lambda 表达式必须通过 {} 包裹。</li>
<li>如果 Lambda 声明了参数部分的类型，且返回值类型支持类型推导，则 Lambda 变量可以省略函数类型声明。</li>
<li>如果 Lambda 变量声明了函数类型，那么 Lambda 的参数部分的类型可以忽略。</li>
<li>如果 Lambda 表达式返回的不是 Unit ，那么默认最后一行的表达式的值类型就是返回值类型。</li>
</ul>
<h3 id="语法糖"><a href="#语法糖" class="headerlink" title="语法糖"></a>语法糖</h3><ul>
<li>单参数隐式名称：Lambda 只有一个参数时，可以用 <code>it</code> 代表</li>
</ul>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p>使用 <code>class</code> 关键字来定义类，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span><br></code></pre></td></tr></table></figure>

<h3 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h3><p>类使用属性来表示状态。<a target="_blank" rel="noopener" href="https://kotlinlang.org/docs/reference/properties.html">属性</a>是类级变量，可以包含 getter、setter 和后备字段。如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span> </span>&#123;<br>    <span class="hljs-keyword">val</span> wheels = listOf&lt;Wheel&gt;()<br>&#125;<br></code></pre></td></tr></table></figure>

<p>请注意，<code>wheels</code> 是一个 <code>public val</code>，这意味着，可以从 <code>Car</code> 类外部访问 <code>wheels</code>，并且不能为其重新赋值。如果要获取 <code>Car</code> 的实例，必须先调用其构造函数。之后可以访问它的任何可访问属性。</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> car = Car() <span class="hljs-comment">// construct a Car</span><br><span class="hljs-keyword">val</span> wheels = car.wheels <span class="hljs-comment">// retrieve the wheels value from the Car</span><br></code></pre></td></tr></table></figure>

<p>如果希望自定义轮子，可以定义一个自定义构造函数，用来指定如何初始化类属性：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span>(<span class="hljs-keyword">val</span> wheels: List&lt;Wheel&gt;)<br></code></pre></td></tr></table></figure>

<h3 id="类函数和封装"><a href="#类函数和封装" class="headerlink" title="类函数和封装"></a>类函数和封装</h3><p>类使用函数对行为建模。函数可以修改状态，从而帮助您只公开希望公开的数据。这种访问控制机制属于一个面向对象的更大概念，称为“封装”。</p>
<p>在以下示例中，<code>doorLock</code> 属性对 <code>Car</code> 类外部的一切都不公开。要解锁汽车，必须调用 <code>unlockDoor()</code> 函数并传入有效的“钥匙”，如以下示例所示：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span>(<span class="hljs-keyword">val</span> wheels: List&lt;Wheel&gt;) &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> doorLock: DoorLock = ...<br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">unlockDoor</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-comment">// Return true if key is valid for door lock, false otherwise</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果希望自定义属性的引用方式，则可以提供自定义的 getter 和 setter。例如，如果希望公开属性的 getter 而限制访问其 setter，则可以将该 setter 指定为 <code>private</code>：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Car</span></span>(<span class="hljs-keyword">val</span> wheels: List&lt;Wheel&gt;) &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> doorLock: DoorLock = ...<br><br>    <span class="hljs-keyword">var</span> gallonsOfFuelInTank: <span class="hljs-built_in">Int</span> = <span class="hljs-number">15</span><br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">set</span><br><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">unlockDoor</span><span class="hljs-params">(key: <span class="hljs-type">Key</span>)</span></span>: <span class="hljs-built_in">Boolean</span> &#123;<br>        <span class="hljs-comment">// Return true if key is valid for door lock, false otherwise</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>通过结合使用属性和函数，可以创建能够对所有类型的对象建模的类。</p>
<h2 id="互操作性"><a href="#互操作性" class="headerlink" title="互操作性"></a>互操作性</h2><p>Kotlin 最重要的功能之一就是它与 Java 之间流畅的互操作性。由于 Kotlin 代码可编译为 JVM 字节码，因此 Kotlin 代码可直接调用 Java 代码，反之亦然。这意味着，您可以直接从 Kotlin 利用现有的 Java 库。此外，绝大多数 Android API 都是用 Java 编写的，因此可以直接从 Kotlin 调用它们。</p>
<h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><h2 id="常用用法"><a href="#常用用法" class="headerlink" title="常用用法"></a>常用用法</h2><h3 id="创建数据类"><a href="#创建数据类" class="headerlink" title="创建数据类"></a>创建数据类</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">data</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Customer</span></span>(<span class="hljs-keyword">val</span> name: String, <span class="hljs-keyword">val</span> email: String)<br></code></pre></td></tr></table></figure>

<p>会为 <code>Customer</code> 类提供以下功能：</p>
<ul>
<li>所有属性的 <code>getter</code> （对于 <code>var</code> 定义的还有 <code>setter</code>）</li>
<li><code>equals()</code></li>
<li><code>hashCode()</code></li>
<li><code>toString()</code></li>
<li><code>copy()</code></li>
<li>所有属性的 <code>component1()</code>、 <code>component2()</code>……等等（参见<a target="_blank" rel="noopener" href="https://www.kotlincn.net/docs/reference/data-classes.html">数据类</a>）</li>
</ul>
<h3 id="函数的默认参数"><a href="#函数的默认参数" class="headerlink" title="函数的默认参数"></a>函数的默认参数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">foo</span><span class="hljs-params">(a: <span class="hljs-type">Int</span> = <span class="hljs-number">0</span>, b: <span class="hljs-type">String</span> = <span class="hljs-string">&quot;&quot;</span>)</span></span> &#123; …… &#125;<br></code></pre></td></tr></table></figure>

<h3 id="过滤-list"><a href="#过滤-list" class="headerlink" title="过滤 list"></a>过滤 list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> positives = list.filter &#123; x -&gt; x &gt; <span class="hljs-number">0</span> &#125;<br></code></pre></td></tr></table></figure>

<p>或者可以更短:</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> positives = list.filter &#123; it &gt; <span class="hljs-number">0</span> &#125;<br></code></pre></td></tr></table></figure>

<h3 id="检测元素是否存在于集合中"><a href="#检测元素是否存在于集合中" class="headerlink" title="检测元素是否存在于集合中"></a>检测元素是否存在于集合中</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;john@example.com&quot;</span> <span class="hljs-keyword">in</span> emailsList) &#123; …… &#125;<br><br><span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;jane@example.com&quot;</span> !<span class="hljs-keyword">in</span> emailsList) &#123; …… &#125;<br></code></pre></td></tr></table></figure>

<h3 id="字符串内插"><a href="#字符串内插" class="headerlink" title="字符串内插"></a>字符串内插</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">println(<span class="hljs-string">&quot;Name <span class="hljs-variable">$name</span>&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="类型判断"><a href="#类型判断" class="headerlink" title="类型判断"></a>类型判断</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">when</span> (x) &#123;<br>    <span class="hljs-keyword">is</span> Foo <span class="hljs-comment">//-&gt; ……</span><br>    <span class="hljs-keyword">is</span> Bar <span class="hljs-comment">//-&gt; ……</span><br>    <span class="hljs-keyword">else</span>   <span class="hljs-comment">//-&gt; ……</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="遍历-map-pair型list"><a href="#遍历-map-pair型list" class="headerlink" title="遍历 map/pair型list"></a>遍历 map/pair型list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">for</span> ((k, v) <span class="hljs-keyword">in</span> map) &#123;<br>    println(<span class="hljs-string">&quot;<span class="hljs-variable">$k</span> -&gt; <span class="hljs-variable">$v</span>&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<p><code>k</code>、<code>v</code> 可以改成任意名字。</p>
<h3 id="使用区间"><a href="#使用区间" class="headerlink" title="使用区间"></a>使用区间</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..<span class="hljs-number">100</span>) &#123; …… &#125;  <span class="hljs-comment">// 闭区间：包含 100</span><br><span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span> until <span class="hljs-number">100</span>) &#123; …… &#125; <span class="hljs-comment">// 半开区间：不包含 100</span><br><span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-number">2</span>..<span class="hljs-number">10</span> step <span class="hljs-number">2</span>) &#123; …… &#125;<br><span class="hljs-keyword">for</span> (x <span class="hljs-keyword">in</span> <span class="hljs-number">10</span> downTo <span class="hljs-number">1</span>) &#123; …… &#125;<br><span class="hljs-keyword">if</span> (x <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..<span class="hljs-number">10</span>) &#123; …… &#125;<br></code></pre></td></tr></table></figure>

<h3 id="只读-list"><a href="#只读-list" class="headerlink" title="只读 list"></a>只读 list</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> list = listOf(<span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="只读-map"><a href="#只读-map" class="headerlink" title="只读 map"></a>只读 map</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> map = mapOf(<span class="hljs-string">&quot;a&quot;</span> to <span class="hljs-number">1</span>, <span class="hljs-string">&quot;b&quot;</span> to <span class="hljs-number">2</span>, <span class="hljs-string">&quot;c&quot;</span> to <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure>

<h3 id="访问-map"><a href="#访问-map" class="headerlink" title="访问 map"></a>访问 map</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin">println(map[<span class="hljs-string">&quot;key&quot;</span>])<br>map[<span class="hljs-string">&quot;key&quot;</span>] = value<br></code></pre></td></tr></table></figure>

<h3 id="延迟属性"><a href="#延迟属性" class="headerlink" title="延迟属性"></a>延迟属性</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> p: String <span class="hljs-keyword">by</span> lazy &#123;<br>    <span class="hljs-comment">// 计算该字符串</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="扩展函数"><a href="#扩展函数" class="headerlink" title="扩展函数"></a>扩展函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> String.<span class="hljs-title">spaceToCamelCase</span><span class="hljs-params">()</span></span> &#123; …… &#125;<br><br><span class="hljs-string">&quot;Convert this to camelcase&quot;</span>.spaceToCamelCase()<br></code></pre></td></tr></table></figure>

<h3 id="创建单例"><a href="#创建单例" class="headerlink" title="创建单例"></a>创建单例</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">object</span> Resource &#123;<br>    <span class="hljs-keyword">val</span> name = <span class="hljs-string">&quot;Name&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="If-not-null-缩写"><a href="#If-not-null-缩写" class="headerlink" title="If not null 缩写"></a>If not null 缩写</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> files = File(<span class="hljs-string">&quot;Test&quot;</span>).listFiles()<br><br>println(files?.size)<br></code></pre></td></tr></table></figure>

<h3 id="If-not-null-and-else-缩写"><a href="#If-not-null-and-else-缩写" class="headerlink" title="If not null and else 缩写"></a>If not null and else 缩写</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> files = File(<span class="hljs-string">&quot;Test&quot;</span>).listFiles()<br><br>println(files?.size ?: <span class="hljs-string">&quot;empty&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="if-null-执行一个语句"><a href="#if-null-执行一个语句" class="headerlink" title="if null 执行一个语句"></a>if null 执行一个语句</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> values = ……<br><span class="hljs-keyword">val</span> email = values[<span class="hljs-string">&quot;email&quot;</span>] ?: <span class="hljs-keyword">throw</span> IllegalStateException(<span class="hljs-string">&quot;Email is missing!&quot;</span>)<br></code></pre></td></tr></table></figure>

<h3 id="在可能会空的集合中取第一元素"><a href="#在可能会空的集合中取第一元素" class="headerlink" title="在可能会空的集合中取第一元素"></a>在可能会空的集合中取第一元素</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> emails = …… <span class="hljs-comment">// 可能会是空集合</span><br><span class="hljs-keyword">val</span> mainEmail = emails.firstOrNull() ?: <span class="hljs-string">&quot;&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="if-not-null-执行代码"><a href="#if-not-null-执行代码" class="headerlink" title="if not null 执行代码"></a>if not null 执行代码</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> value = ……<br><br>value?.let &#123;<br>    …… <span class="hljs-comment">// 代码会执行到此处, 假如data不为null</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="映射可空值（如果非空的话）"><a href="#映射可空值（如果非空的话）" class="headerlink" title="映射可空值（如果非空的话）"></a>映射可空值（如果非空的话）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> value = ……<br><br><span class="hljs-keyword">val</span> mapped = value?.let &#123; transformValue(it) &#125; ?: defaultValue <br><span class="hljs-comment">// 如果该值或其转换结果为空，那么返回 defaultValue。</span><br></code></pre></td></tr></table></figure>

<h3 id="返回-when-表达式"><a href="#返回-when-表达式" class="headerlink" title="返回 when 表达式"></a>返回 when 表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(color: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (color) &#123;<br>        <span class="hljs-string">&quot;Red&quot;</span> -&gt; <span class="hljs-number">0</span><br>        <span class="hljs-string">&quot;Green&quot;</span> -&gt; <span class="hljs-number">1</span><br>        <span class="hljs-string">&quot;Blue&quot;</span> -&gt; <span class="hljs-number">2</span><br>        <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">throw</span> IllegalArgumentException(<span class="hljs-string">&quot;Invalid color param value&quot;</span>)<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="“try-catch”表达式"><a href="#“try-catch”表达式" class="headerlink" title="“try/catch”表达式"></a>“try/catch”表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">test</span><span class="hljs-params">()</span></span> &#123;<br>    <span class="hljs-keyword">val</span> result = <span class="hljs-keyword">try</span> &#123;<br>        count()<br>    &#125; <span class="hljs-keyword">catch</span> (e: ArithmeticException) &#123;<br>        <span class="hljs-keyword">throw</span> IllegalStateException(e)<br>    &#125;<br><br>    <span class="hljs-comment">// 使用 result</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="“if”表达式"><a href="#“if”表达式" class="headerlink" title="“if”表达式"></a>“if”表达式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">foo</span><span class="hljs-params">(param: <span class="hljs-type">Int</span>)</span></span> &#123;<br>    <span class="hljs-keyword">val</span> result = <span class="hljs-keyword">if</span> (param == <span class="hljs-number">1</span>) &#123;<br>        <span class="hljs-string">&quot;one&quot;</span><br>    &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (param == <span class="hljs-number">2</span>) &#123;<br>        <span class="hljs-string">&quot;two&quot;</span><br>    &#125; <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-string">&quot;three&quot;</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="返回类型为-Unit-的方法的-Builder-风格用法"><a href="#返回类型为-Unit-的方法的-Builder-风格用法" class="headerlink" title="返回类型为 Unit 的方法的 Builder 风格用法"></a>返回类型为 <code>Unit</code> 的方法的 Builder 风格用法</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">arrayOfMinusOnes</span><span class="hljs-params">(size: <span class="hljs-type">Int</span>)</span></span>: IntArray &#123;<br>    <span class="hljs-keyword">return</span> IntArray(size).apply &#123; fill(-<span class="hljs-number">1</span>) &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="单表达式函数"><a href="#单表达式函数" class="headerlink" title="单表达式函数"></a>单表达式函数</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">theAnswer</span><span class="hljs-params">()</span></span> = <span class="hljs-number">42</span><br></code></pre></td></tr></table></figure>

<p>等价于</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">theAnswer</span><span class="hljs-params">()</span></span>: <span class="hljs-built_in">Int</span> &#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">42</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>单表达式函数与其它惯用法一起使用能简化代码，例如和 <em>when</em> 表达式一起使用：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">transform</span><span class="hljs-params">(color: <span class="hljs-type">String</span>)</span></span>: <span class="hljs-built_in">Int</span> = <span class="hljs-keyword">when</span> (color) &#123;<br>    <span class="hljs-string">&quot;Red&quot;</span> -&gt; <span class="hljs-number">0</span><br>    <span class="hljs-string">&quot;Green&quot;</span> -&gt; <span class="hljs-number">1</span><br>    <span class="hljs-string">&quot;Blue&quot;</span> -&gt; <span class="hljs-number">2</span><br>    <span class="hljs-keyword">else</span> -&gt; <span class="hljs-keyword">throw</span> IllegalArgumentException(<span class="hljs-string">&quot;Invalid color param value&quot;</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="对一个对象实例调用多个方法-（with）"><a href="#对一个对象实例调用多个方法-（with）" class="headerlink" title="对一个对象实例调用多个方法 （with）"></a>对一个对象实例调用多个方法 （<code>with</code>）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Turtle</span> </span>&#123;<br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">penDown</span><span class="hljs-params">()</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">penUp</span><span class="hljs-params">()</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">turn</span><span class="hljs-params">(degrees: <span class="hljs-type">Double</span>)</span></span><br>    <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">forward</span><span class="hljs-params">(pixels: <span class="hljs-type">Double</span>)</span></span><br>&#125;<br><br><span class="hljs-keyword">val</span> myTurtle = Turtle()<br>with(myTurtle) &#123; <span class="hljs-comment">// 画一个 100 像素的正方形</span><br>    penDown()<br>    <span class="hljs-keyword">for</span> (i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span>..<span class="hljs-number">4</span>) &#123;<br>        forward(<span class="hljs-number">100.0</span>)<br>        turn(<span class="hljs-number">90.0</span>)<br>    &#125;<br>    penUp()<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="配置对象的属性（apply）"><a href="#配置对象的属性（apply）" class="headerlink" title="配置对象的属性（apply）"></a>配置对象的属性（<code>apply</code>）</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> myRectangle = Rectangle().apply &#123;<br>    length = <span class="hljs-number">4</span><br>    breadth = <span class="hljs-number">5</span><br>    color = <span class="hljs-number">0xFAFAFA</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>这对于配置未出现在对象构造函数中的属性非常有用。</p>
<h3 id="Java-7-的-try-with-resources"><a href="#Java-7-的-try-with-resources" class="headerlink" title="Java 7 的 try with resources"></a>Java 7 的 try with resources</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> stream = Files.newInputStream(Paths.<span class="hljs-keyword">get</span>(<span class="hljs-string">&quot;/some/file.txt&quot;</span>))<br>stream.buffered().reader().use &#123; reader -&gt;<br>    println(reader.readText())<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="对于需要泛型信息的泛型函数的适宜形式"><a href="#对于需要泛型信息的泛型函数的适宜形式" class="headerlink" title="对于需要泛型信息的泛型函数的适宜形式"></a>对于需要泛型信息的泛型函数的适宜形式</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-comment">//  public final class Gson &#123;</span><br><span class="hljs-comment">//     ……</span><br><span class="hljs-comment">//     public &lt;T&gt; T fromJson(JsonElement json, Class&lt;T&gt; classOfT) throws JsonSyntaxException &#123;</span><br><span class="hljs-comment">//     ……</span><br><br><span class="hljs-keyword">inline</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-type">&lt;<span class="hljs-keyword">reified</span> T: Any&gt;</span> Gson.<span class="hljs-title">fromJson</span><span class="hljs-params">(json: <span class="hljs-type">JsonElement</span>)</span></span>: T = <span class="hljs-keyword">this</span>.fromJson(json, T::<span class="hljs-keyword">class</span>.java)<br></code></pre></td></tr></table></figure>

<h3 id="使用可空布尔"><a href="#使用可空布尔" class="headerlink" title="使用可空布尔"></a>使用可空布尔</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">val</span> b: <span class="hljs-built_in">Boolean</span>? = ……<br><span class="hljs-keyword">if</span> (b == <span class="hljs-literal">true</span>) &#123;<br>    ……<br>&#125; <span class="hljs-keyword">else</span> &#123;<br>    <span class="hljs-comment">// `b` 是 false 或者 null</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="交换两个变量"><a href="#交换两个变量" class="headerlink" title="交换两个变量"></a>交换两个变量</h3><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-keyword">var</span> a = <span class="hljs-number">1</span><br><span class="hljs-keyword">var</span> b = <span class="hljs-number">2</span><br>a = b.also &#123; b = a &#125;<br></code></pre></td></tr></table></figure>

<h3 id="TODO-：将代码标记为不完整"><a href="#TODO-：将代码标记为不完整" class="headerlink" title="TODO()：将代码标记为不完整"></a>TODO()：将代码标记为不完整</h3><p>Kotlin 的标准库有一个 <code>TODO()</code> 函数，该函数总是抛出一个 <code>NotImplementedError</code>。 其返回类型为 <code>Nothing</code>，因此无论预期类型是什么都可以使用它。 还有一个接受原因参数的重载：</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs kotlin"><span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">calcTaxes</span><span class="hljs-params">()</span></span>: BigDecimal = TODO(<span class="hljs-string">&quot;Waiting for feedback from accounting&quot;</span>)<br></code></pre></td></tr></table></figure>

<p>IntelliJ IDEA 的 kotlin 插件理解 <code>TODO()</code> 的语言，并且会自动在 TODO 工具窗口中添加代码指示。</p>
<h2 id="编码规范"><a href="#编码规范" class="headerlink" title="编码规范"></a>编码规范</h2><h3 id="源文件名称"><a href="#源文件名称" class="headerlink" title="源文件名称"></a>源文件名称</h3><p>如果 Kotlin 文件包含单个类（以及可能相关的顶层声明），那么文件名应该与该类的名称相同，并追加 .kt 扩展名。如果文件包含多个类或只包含顶层声明， 那么选择一个描述该文件所包含内容的名称，并以此命名该文件。 使用首字母大写的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%A7%9D%E5%B3%B0%E5%BC%8F%E5%A4%A7%E5%B0%8F%E5%AF%AB">驼峰风格</a>（例如 <code>ProcessDeclarations.kt</code>）。</p>
<p>文件的名称应该描述文件中代码的作用。因此，应避免在文件名中使用诸如“Util”之类的无意义词语。</p>
<h3 id="源文件组织"><a href="#源文件组织" class="headerlink" title="源文件组织"></a>源文件组织</h3><p>鼓励多个声明（类、顶级函数或者属性）放在同一个 Kotlin 源文件中， 只要这些声明在语义上彼此紧密关联并且文件保持合理大小 （不超过几百行）。</p>
<p>特别是在为类定义与类的所有客户都相关的扩展函数时， 请将它们放在与类自身定义相同的地方。而在定义仅对指定客户有意义的扩展函数时，请将它们放在紧挨该客户代码之后。不要只是为了保存 “Foo 的所有扩展函数”而创建文件。</p>
<h3 id="类布局"><a href="#类布局" class="headerlink" title="类布局"></a>类布局</h3><p>通常，一个类的内容按以下顺序排列：</p>
<ul>
<li>属性声明与初始化块</li>
<li>次构造函数</li>
<li>方法声明</li>
<li>伴生对象</li>
</ul>
<p>不要按字母顺序或者可见性对方法声明排序，也不要将常规方法与扩展方法分开。而是要把相关的东西放在一起，这样从上到下阅读类的人就能够跟进所发生事情的逻辑。选择一个顺序（高级别优先，或者相反）并坚持下去。</p>
<p>将嵌套类放在紧挨使用这些类的代码之后。如果打算在外部使用嵌套类，而且类中并没有引用这些类，那么把它们放到末尾，在伴生对象之后。</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">wanggh8</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://129921.xyz/Android/Kotlin/">https://129921.xyz/Android/Kotlin/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本站所有文章除特别声明外，均采用 <a href="http://www.opensource.org/licenses/Apache-2.0" target="_blank">Apache-2.0</a> 许可协议。转载请注明来自 <a href="https://129921.xyz" target="_blank">Petithao</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Android/">Android</a></div><div class="post_share"><div class="social-share" data-image="/images/kotlin.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/Android/PopupWindow/"><img class="prev-cover" data-lazy-src="/images/android-black.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PopupWindow</div></div></a></div><div class="next-post pull-right"><a href="/Android/Android%20rule/"><img class="next-cover" data-lazy-src="/images/android-black.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Android Rule</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/Android/Activity/" title="Android Activity"><img class="relatedPosts_cover" data-lazy-src="/images/android-black.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-15</div><div class="relatedPosts_title">Android Activity</div></div></a></div><div class="relatedPosts_item"><a href="/Android/Android Library/" title="Android开源框架"><img class="relatedPosts_cover" data-lazy-src="/images/android-black.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-21</div><div class="relatedPosts_title">Android开源框架</div></div></a></div><div class="relatedPosts_item"><a href="/Android/Android Studio/" title="Android Studio 指南"><img class="relatedPosts_cover" data-lazy-src="/images/android-black.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-16</div><div class="relatedPosts_title">Android Studio 指南</div></div></a></div></div></div></article></main><footer id="footer" style="background-image: url(/images/kotlin-android.jpg)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2017 - 2021 By wanggh8</div><div class="icp"><a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备20009142号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="/js/third-party/canvas-nest.js"></script></div></body></html>